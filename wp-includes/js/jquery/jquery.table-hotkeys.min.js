(function(n){n.fn.filter_visible=function(t){t=t||3;var i=function(){for(var i=n(this),r=0;r<t-1;++r){if(!i.is(":visible"))return!1;i=i.parent()}return!0};return this.filter(i)};n.table_hotkeys=function(t,i,r){r=n.extend(n.table_hotkeys.defaults,r);var e,c,u,o,l,f,a,v,y,s,p,w,h;(e=r.class_prefix+r.selected_suffix,c=r.class_prefix+r.destructive_suffix,u=function(t){n.table_hotkeys.current_row&&n.table_hotkeys.current_row.removeClass(e);t.addClass(e);t[0].scrollIntoView(!1);n.table_hotkeys.current_row=t},o=function(t){!f(t)&&n.isFunction(r[t+"_page_link_cb"])&&r[t+"_page_link_cb"]()},l=function(t){var i,u;return n.table_hotkeys.current_row?(u="prev"==t?n.fn.prevAll:n.fn.nextAll,u.call(n.table_hotkeys.current_row,r.cycle_expr).filter_visible()[0]):(i=s(),n.table_hotkeys.current_row=i,i[0])},f=function(t){var i=l(t);return i?(u(n(i)),!0):!1},a=function(){return f("prev")},v=function(){return f("next")},y=function(){n(r.checkbox_expr,n.table_hotkeys.current_row).each(function(){this.checked=!this.checked})},s=function(){return n(r.cycle_expr,t).filter_visible().eq(r.start_row_index)},p=function(){var i=n(r.cycle_expr,t).filter_visible();return i.eq(i.length-1)},w=function(t){return function(){if(null==n.table_hotkeys.current_row)return!1;var i=n(t,n.table_hotkeys.current_row);if(!i.length)return!1;i.is("."+c)&&(v()||a());i.click()}},h=s(),h.length)&&(r.highlight_first?u(h):r.highlight_last&&u(p()),n.hotkeys.add(r.prev_key,r.hotkeys_opts,function(){return o("prev")}),n.hotkeys.add(r.next_key,r.hotkeys_opts,function(){return o("next")}),n.hotkeys.add(r.mark_key,r.hotkeys_opts,y),n.each(i,function(){var i,t;n.isFunction(this[1])?(i=this[1],t=this[0],n.hotkeys.add(t,r.hotkeys_opts,function(t){return i(t,n.table_hotkeys.current_row)})):(t=this,n.hotkeys.add(t,r.hotkeys_opts,w("."+r.class_prefix+t)))}))};n.table_hotkeys.current_row=null;n.table_hotkeys.defaults={cycle_expr:"tr",class_prefix:"vim-",selected_suffix:"current",destructive_suffix:"destructive",hotkeys_opts:{disableInInput:!0,type:"keypress"},checkbox_expr:":checkbox",next_key:"j",prev_key:"k",mark_key:"x",start_row_index:2,highlight_first:!1,highlight_last:!1,next_page_link_cb:!1,prev_page_link_cb:!1}})(jQuery)