(function(n){n.scheduler=function(){this.bucket={};return};n.scheduler.prototype={schedule:function(){function u(n){return!!n&&typeof n!="string"&&typeof n[0]=="undefined"&&RegExp("function","i").test(n+"")}var n={id:null,time:1e3,repeat:!1,protect:!1,obj:null,func:function(){},args:[]},t=0,f=!1,i,r;if(typeof arguments[t]=="object"&&arguments.length>1&&(f=!0,t++),typeof arguments[t]=="object"){for(i in arguments[t])typeof n[i]!="undefined"&&(n[i]=arguments[t][i]);t++}for((typeof arguments[t]=="number"||typeof arguments[t]=="string"&&arguments[t].match(RegExp("^[0-9]+[smhdw]$")))&&(n.time=arguments[t++]),typeof arguments[t]=="boolean"&&(n.repeat=arguments[t++]),typeof arguments[t]=="boolean"&&(n.protect=arguments[t++]),typeof arguments[t]=="object"&&typeof arguments[t+1]=="string"&&u(arguments[t][arguments[t+1]])?(n.obj=arguments[t++],n.func=arguments[t++]):typeof arguments[t]!="undefined"&&(u(arguments[t])||typeof arguments[t]=="string")&&(n.func=arguments[t++]);typeof arguments[t]!="undefined";)n.args.push(arguments[t++]);if(f){if(typeof arguments[1]=="object")for(i in arguments[0])typeof n[i]!="undefined"&&typeof arguments[1][i]=="undefined"&&(n[i]=arguments[0][i]);else for(i in arguments[0])typeof n[i]!="undefined"&&(n[i]=arguments[0][i]);t++}return(n._scheduler=this,n._handle=null,r=String(n.time).match(RegExp("^([0-9]+)([smhdw])$")),r&&r[0]!="undefined"&&r[1]!="undefined"&&(n.time=String(parseInt(r[1])*{s:1e3,m:6e4,h:36e5,d:864e5,w:6048e5}[r[2]])),n.id==null&&(n.id=String(n.repeat)+":"+String(n.protect)+":"+String(n.time)+":"+String(n.obj)+":"+String(n.func)+":"+String(n.args)),n.protect&&typeof this.bucket[n.id]!="undefined")?this.bucket[n.id]:(u(n.func)||(n.func=n.obj!=null&&typeof n.obj=="object"&&typeof n.func=="string"&&u(n.obj[n.func])?n.obj[n.func]:eval("function () { "+n.func+" }")),n._handle=this._schedule(n),this.bucket[n.id]=n,n)},reschedule:function(n){return typeof n=="string"&&(n=this.bucket[n]),n._handle=this._schedule(n),n},_schedule:function(n){var t=function(){var t=n.obj!=null?n.obj:n;n.func.apply(t,n.args);typeof n._scheduler.bucket[n.id]!="undefined"&&n.repeat?n._scheduler._schedule(n):delete n._scheduler.bucket[n.id]};return setTimeout(t,n.time)},cancel:function(n){typeof n=="string"&&(n=this.bucket[n]);typeof n=="object"&&(clearTimeout(n._handle),delete this.bucket[n.id])}};n.extend({scheduler$:new n.scheduler,schedule:function(){return n.scheduler$.schedule.apply(n.scheduler$,arguments)},reschedule:function(){return n.scheduler$.reschedule.apply(n.scheduler$,arguments)},cancel:function(){return n.scheduler$.cancel.apply(n.scheduler$,arguments)}});n.fn.extend({schedule:function(){for(var t=[{}],i=0;i<arguments.length;i++)t.push(arguments[i]);return this.each(function(){return t[0]={id:this,obj:this},n.schedule.apply(n,t)})}})})(jQuery)