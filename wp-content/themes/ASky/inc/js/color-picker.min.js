(function(n,t){var i='<a tabindex="0" class="wp-color-result" />',r='<div class="wp-picker-holder" />',u='<div class="wp-picker-container" />',f='<input type="button" class="button button-small hidden" />',e={options:{defaultColor:!1,change:!1,clear:!1,hide:!0,palettes:!0},_create:function(){if(!n.browser.msie||!(parseInt(n.browser.version,10)<8)){var t=this,e=t.element;n.extend(t.options,e.data());t.initialValue=e.val();e.addClass("wp-color-picker").hide().wrap(u);t.wrap=e.parent();t.toggler=n(i).insertBefore(e).css({backgroundColor:t.initialValue}).attr("title",wpColorPickerL10n.pick).attr("data-current",wpColorPickerL10n.current);t.pickerContainer=n(r).insertAfter(e);t.button=n(f);t.options.defaultColor?t.button.addClass("wp-picker-default").val(wpColorPickerL10n.defaultString):t.button.addClass("wp-picker-clear").val(wpColorPickerL10n.clear);e.wrap('<span class="wp-picker-input-wrap" />').after(t.button);e.iris({target:t.pickerContainer,hide:!0,width:255,mode:"hsv",palettes:t.options.palettes,change:function(i,r){t.toggler.css({backgroundColor:r.color.toString()});n.isFunction(t.options.change)&&t.options.change.call(this,i,r)}});e.val(t.initialValue);t._addListeners();t.options.hide||t.toggler.click()}},_addListeners:function(){var t=this;t.toggler.click(function(i){if(i.stopPropagation(),t.element.toggle().iris("toggle"),t.button.toggleClass("hidden"),t.toggler.toggleClass("wp-picker-open"),t.toggler.hasClass("wp-picker-open"))n("body").on("click",{wrap:t.wrap,toggler:t.toggler},t._bodyListener);else n("body").off("click",t._bodyListener)});t.element.change(function(i){var u=n(this),r=u.val();(r===""||r==="#")&&(t.toggler.css("backgroundColor",""),n.isFunction(t.options.clear)&&t.options.clear.call(this,i))});t.toggler.on("keyup",function(n){(n.keyCode===13||n.keyCode===32)&&(n.preventDefault(),t.toggler.trigger("click").next().focus())});t.button.click(function(i){var r=n(this);r.hasClass("wp-picker-clear")?(t.element.val(""),t.toggler.css("backgroundColor",""),n.isFunction(t.options.clear)&&t.options.clear.call(this,i)):r.hasClass("wp-picker-default")&&t.element.val(t.options.defaultColor).change()})},_bodyListener:function(n){n.data.wrap.find(n.target).length||n.data.toggler.click()},color:function(n){if(n===t)return this.element.iris("option","color");this.element.iris("option","color",n)},defaultColor:function(n){if(n===t)return this.options.defaultColor;this.options.defaultColor=n}};n.widget("wp.wpColorPicker",e)})(jQuery)